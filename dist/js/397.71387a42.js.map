{"version":3,"file":"js/397.71387a42.js","mappings":"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","sources":["webpack://vue-shop/./src/components/power/RoleList.vue?7892","webpack://vue-shop/src/components/power/RoleList.vue","webpack://vue-shop/./src/components/power/RoleList.vue?226b","webpack://vue-shop/./src/components/power/RoleList.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"role-wrapper\"},[_c('el-card',[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":2}},[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-plus\"},on:{\"click\":_vm.addRole}},[_vm._v(\"新增角色\")])],1)],1),_c('el-table',{staticClass:\"role-table\",attrs:{\"data\":_vm.roleList,\"border\":\"\",\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.children.length !== 0)?_c('div',_vm._l((scope.row.children),function(item,index){return _c('el-row',{key:item.id,class:['bottom', index === 0 ? 'top' : ''],attrs:{\"type\":\"flex\",\"align\":\"middle\",\"justify\":\"center\"}},[_c('el-col',{attrs:{\"span\":5}},[_c('el-tag',{attrs:{\"type\":\"success\",\"closable\":\"\"},on:{\"close\":function($event){return _vm.removeRole(scope.row, item.id)}}},[_vm._v(_vm._s(item.authName))]),_c('i',{staticClass:\"el-icon-caret-right\"})],1),_c('el-col',{attrs:{\"span\":19}},_vm._l((item.children),function(list,index2){return _c('el-row',{key:list.id,class:[index2 === 0 ? '' : 'top'],attrs:{\"type\":\"flex\",\"align\":\"middle\",\"justify\":\"center\"}},[_c('el-col',{attrs:{\"span\":6}},[_c('el-tag',{attrs:{\"type\":\"warning\",\"closable\":\"\"},on:{\"close\":function($event){return _vm.removeRole(scope.row, list.id)}}},[_vm._v(_vm._s(list.authName))]),_c('i',{staticClass:\"el-icon-caret-right\"})],1),_c('el-col',{attrs:{\"span\":18}},_vm._l((list.children),function(list2){return _c('el-tag',{key:list2.id,attrs:{\"closable\":\"\",\"type\":\"danger\"},on:{\"close\":function($event){return _vm.removeRole(scope.row, list2.id)}}},[_vm._v(_vm._s(list2.authName))])}),1)],1)}),1)],1)}),1):_c('div',{staticClass:\"nopower\"},[_vm._v(\"暂无权限\")])]}}])}),_c('el-table-column',{attrs:{\"type\":\"index\",\"label\":\"#\"}}),_c('el-table-column',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}}),_c('el-table-column',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"icon\":\"el-icon-edit\"},on:{\"click\":function($event){return _vm.editRole(scope.row.id)}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"small\",\"icon\":\"el-icon-delete\"},on:{\"click\":function($event){return _vm.deleteRole(scope.row.id)}}},[_vm._v(\"删除\")]),_c('el-button',{attrs:{\"type\":\"warning\",\"size\":\"small\",\"icon\":\"el-icon-setting\"},on:{\"click\":function($event){return _vm.settingRole(scope.row)}}},[_vm._v(\"分配权限\")])]}}])})],1)],1),_c('el-dialog',{attrs:{\"title\":\"分配权限\",\"width\":\"30%\",\"visible\":_vm.roleDialogVisible},on:{\"update:visible\":function($event){_vm.roleDialogVisible=$event},\"close\":_vm.roleDialogClose}},[_c('el-tree',{ref:\"treeRole\",attrs:{\"data\":_vm.powerList,\"props\":_vm.poserProps,\"show-checkbox\":\"\",\"default-expand-all\":\"\",\"node-key\":\"id\",\"default-checked-keys\":_vm.defaultPoserList}}),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.roleDialogVisible = false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveRoleList}},[_vm._v(\"确定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"新增角色\",\"width\":\"30%\",\"visible\":_vm.addRoleDialogVisible},on:{\"update:visible\":function($event){_vm.addRoleDialogVisible=$event},\"close\":_vm.addRoleDialogClose}},[_c('el-form',{ref:\"addRoleRef\",attrs:{\"model\":_vm.addRoleForm,\"rules\":_vm.addRoleFormRules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"prop\":\"roleName\",\"label\":\"角色名称\"}},[_c('el-input',{model:{value:(_vm.addRoleForm.roleName),callback:function ($$v) {_vm.$set(_vm.addRoleForm, \"roleName\", $$v)},expression:\"addRoleForm.roleName\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"roleDesc\",\"label\":\"角色描述\"}},[_c('el-input',{model:{value:(_vm.addRoleForm.roleDesc),callback:function ($$v) {_vm.$set(_vm.addRoleForm, \"roleDesc\", $$v)},expression:\"addRoleForm.roleDesc\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.addRoleDialogVisible = false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveAddRole}},[_vm._v(\"确定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"编辑角色\",\"width\":\"30%\",\"visible\":_vm.editRoleDialogVisible},on:{\"update:visible\":function($event){_vm.editRoleDialogVisible=$event},\"close\":_vm.editRoleDialogClose}},[_c('el-form',{ref:\"editRoleRef\",attrs:{\"model\":_vm.editRoleForm,\"rules\":_vm.editRoleFormRules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"prop\":\"roleName\",\"label\":\"角色名称\"}},[_c('el-input',{model:{value:(_vm.editRoleForm.roleName),callback:function ($$v) {_vm.$set(_vm.editRoleForm, \"roleName\", $$v)},expression:\"editRoleForm.roleName\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"roleDesc\",\"label\":\"角色描述\"}},[_c('el-input',{model:{value:(_vm.editRoleForm.roleDesc),callback:function ($$v) {_vm.$set(_vm.editRoleForm, \"roleDesc\", $$v)},expression:\"editRoleForm.roleDesc\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.editRoleDialogVisible = false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveEditRole}},[_vm._v(\"确定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"role-wrapper\">\r\n    <el-card>\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"2\">\r\n          <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"addRole\">新增角色</el-button>\r\n        </el-col>\r\n      </el-row>\r\n      <el-table :data=\"roleList\" border stripe class=\"role-table\">\r\n        <!-- 展开列 -->\r\n        <el-table-column type=\"expand\">\r\n          <template slot-scope=\"scope\">\r\n            <div v-if=\"scope.row.children.length !== 0\">\r\n              <el-row :class=\"['bottom', index === 0 ? 'top' : '']\" type=\"flex\" align=\"middle\" justify=\"center\" v-for=\"(item, index) in scope.row.children\" :key=\"item.id\">\r\n                <!-- 一级权限 -->\r\n                <el-col :span=\"5\">\r\n                  <el-tag type=\"success\" closable @close=\"removeRole(scope.row, item.id)\">{{ item.authName }}</el-tag>\r\n                  <i class=\"el-icon-caret-right\"></i>\r\n                </el-col>\r\n                <!-- 二级与三级权限 -->\r\n                <el-col :span=\"19\">\r\n                  <el-row type=\"flex\" align=\"middle\" justify=\"center\" :class=\"[index2 === 0 ? '' : 'top']\" v-for=\"(list, index2) in item.children\" :key=\"list.id\">\r\n                    <!-- 二级权限 -->\r\n                    <el-col :span=\"6\">\r\n                      <el-tag type=\"warning\" closable @close=\"removeRole(scope.row, list.id)\">{{ list.authName }}</el-tag>\r\n                      <i class=\"el-icon-caret-right\"></i>\r\n                    </el-col>\r\n                    <!-- 三级权限 -->\r\n                    <el-col :span=\"18\">\r\n                      <el-tag closable @close=\"removeRole(scope.row, list2.id)\" type=\"danger\" v-for=\"list2 in list.children\" :key=\"list2.id\">{{ list2.authName }}</el-tag>\r\n                    </el-col>\r\n                  </el-row>\r\n                </el-col>\r\n              </el-row>\r\n            </div>\r\n            <div v-else class=\"nopower\">暂无权限</div>\r\n          </template>\r\n        </el-table-column>\r\n        <!-- 索引列 -->\r\n        <el-table-column type=\"index\" label=\"#\"></el-table-column>\r\n        <el-table-column label=\"角色名称\" prop=\"roleName\"></el-table-column>\r\n        <el-table-column label=\"角色描述\" prop=\"roleDesc\"></el-table-column>\r\n        <el-table-column label=\"操作\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"primary\" size=\"small\" icon=\"el-icon-edit\" @click=\"editRole(scope.row.id)\">编辑</el-button>\r\n            <el-button type=\"danger\" size=\"small\" icon=\"el-icon-delete\" @click=\"deleteRole(scope.row.id)\">删除</el-button>\r\n            <el-button type=\"warning\" size=\"small\" icon=\"el-icon-setting\" @click=\"settingRole(scope.row)\">分配权限</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n    <!-- 分配权限弹窗 -->\r\n    <el-dialog title=\"分配权限\" width=\"30%\" :visible.sync=\"roleDialogVisible\" @close=\"roleDialogClose\">\r\n      <el-tree\r\n      :data=\"powerList\"\r\n      :props=\"poserProps\"\r\n      show-checkbox\r\n      default-expand-all\r\n      node-key=\"id\"\r\n      :default-checked-keys=\"defaultPoserList\"\r\n      ref=\"treeRole\">\r\n      </el-tree>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"roleDialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveRoleList\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 新增角色弹窗 -->\r\n    <el-dialog title=\"新增角色\" width=\"30%\" :visible.sync=\"addRoleDialogVisible\" @close=\"addRoleDialogClose\">\r\n      <el-form :model=\"addRoleForm\" :rules=\"addRoleFormRules\" ref=\"addRoleRef\" label-width=\"100px\">\r\n         <el-form-item prop=\"roleName\" label=\"角色名称\">\r\n          <el-input v-model=\"addRoleForm.roleName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"roleDesc\" label=\"角色描述\">\r\n          <el-input v-model=\"addRoleForm.roleDesc\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"addRoleDialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveAddRole\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n     <!-- 新增角色弹窗 -->\r\n    <el-dialog title=\"编辑角色\" width=\"30%\" :visible.sync=\"editRoleDialogVisible\" @close=\"editRoleDialogClose\">\r\n      <el-form :model=\"editRoleForm\" :rules=\"editRoleFormRules\" ref=\"editRoleRef\" label-width=\"100px\">\r\n         <el-form-item prop=\"roleName\" label=\"角色名称\">\r\n          <el-input v-model=\"editRoleForm.roleName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"roleDesc\" label=\"角色描述\">\r\n          <el-input v-model=\"editRoleForm.roleDesc\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"editRoleDialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveEditRole\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data () {\r\n    return {\r\n      // 所有角色列表\r\n      roleList: [],\r\n      // 权限分配弹窗显示与隐藏\r\n      roleDialogVisible: false,\r\n      // 所有权限列表数据\r\n      powerList: [],\r\n      // tree配置选项\r\n      poserProps: {\r\n        label: 'authName',\r\n        children: 'children'\r\n      },\r\n      // 默认展开的权限列表\r\n      defaultPoserList: [],\r\n      // 当前角色id\r\n      roleId: '',\r\n      // 新增角色弹窗\r\n      addRoleDialogVisible: false,\r\n      // 新增角色数据\r\n      addRoleForm: {\r\n        roleName: '',\r\n        roleDesc: ''\r\n      },\r\n      // 校验规则\r\n      addRoleFormRules: {\r\n        roleName: [\r\n          { required: true, message: '请输入角色名称', trigger: 'blur' },\r\n          { min: 2, max: 8, message: '长度在 2 到 8 个字符', trigger: 'blur' }\r\n        ],\r\n        roleDesc: [\r\n          { required: true, message: '请输入角色描述', trigger: 'blur' },\r\n          { min: 3, max: 10, message: '长度在 3 到 10 个字符', trigger: 'blur' }\r\n        ]\r\n      },\r\n      editRoleFormRules: {\r\n        roleName: [\r\n          { required: true, message: '请输入角色名称', trigger: 'blur' },\r\n          { min: 2, max: 8, message: '长度在 2 到 8 个字符', trigger: 'blur' }\r\n        ],\r\n        roleDesc: [\r\n          { required: true, message: '请输入角色描述', trigger: 'blur' },\r\n          { min: 3, max: 10, message: '长度在 3 到 10 个字符', trigger: 'blur' }\r\n        ]\r\n      },\r\n      // 编辑角色数据\r\n      editRoleForm: {},\r\n      // 编辑角色弹窗\r\n      editRoleDialogVisible: false\r\n    }\r\n  },\r\n  created () {\r\n    // 初始加载所有角色权限\r\n    this.getRoleList()\r\n  },\r\n  methods: {\r\n    async getRoleList () {\r\n      const { data: res } = await this.$axios.get('roles')\r\n      if (res.meta.status !== 200) {\r\n        return this.$message.error(res.meta.msg)\r\n      }\r\n      this.roleList = res.data\r\n    },\r\n    // 根据id删除对应权限\r\n    removeRole (role, roleId) {\r\n      this.$confirm(\r\n        '此操作将永久删除该权限, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }\r\n      ).then(async () => {\r\n        const { data: res } = await this.$axios.delete(`roles/${role.id}/rights/${roleId}`)\r\n        if (res.meta.status !== 200) {\r\n          return this.$message.error(res.meta.msg)\r\n        }\r\n        role.children = res.data\r\n      }).catch(() => {\r\n        return this.$message.info('取消删除')\r\n      })\r\n    },\r\n    // 展示分配权限弹框\r\n    async settingRole (role) {\r\n      this.roleId = role.id\r\n      this.roleDialogVisible = true\r\n      this.getPoserKeys(role, this.defaultPoserList)\r\n      // 获取所有权限列表tree\r\n      const { data: res } = await this.$axios.get('rights/tree')\r\n      if (res.meta.status !== 200) {\r\n        return this.$message.error(res.meta.msg)\r\n      }\r\n      this.powerList = res.data\r\n    },\r\n    // 递归实现获取角色权限\r\n    getPoserKeys (node, arr) {\r\n      if (!node.children) {\r\n        return arr.push(node.id)\r\n      }\r\n      node.children.forEach(item => {\r\n        this.getPoserKeys(item, arr)\r\n      })\r\n    },\r\n    // 关闭弹窗\r\n    roleDialogClose () {\r\n      this.defaultPoserList = []\r\n    },\r\n    // 确定按钮分配权限保存\r\n    async saveRoleList () {\r\n      this.roleDialogVisible = false\r\n      const keys = [\r\n        ...this.$refs.treeRole.getCheckedKeys(),\r\n        ...this.$refs.treeRole.getHalfCheckedNodes()\r\n      ]\r\n      const idStr = keys.join(',')\r\n      const { data: res } = await this.$axios.post(`roles/${this.roleId}/rights`, { rids: idStr })\r\n      if (res.meta.status !== 200) {\r\n        return this.$message.error(res.meta.msg)\r\n      }\r\n      this.$message.success(res.meta.msg)\r\n      // 刷新角色权限数据\r\n      this.getRoleList()\r\n      // 关闭分配权限弹窗\r\n      this.roleDialogVisible = false\r\n    },\r\n    // 新增角色\r\n    addRole () {\r\n      this.addRoleDialogVisible = true\r\n    },\r\n    // 新增角色弹窗关闭\r\n    addRoleDialogClose () {\r\n      this.$refs.addRoleRef.resetFields()\r\n    },\r\n    // 保存新增角色\r\n    saveAddRole () {\r\n      this.$refs.addRoleRef.validate(async bool => {\r\n        if (!bool) return false\r\n        const { data: res } = await this.$axios.post('roles', this.addRoleForm)\r\n        if (res.meta.status !== 201) {\r\n          this.$message.error(res.meta.msg)\r\n        } else {\r\n          this.$message.success(res.meta.msg)\r\n          this.addRoleDialogVisible = false\r\n          // 重新获取角色列表\r\n          this.getRoleList()\r\n        }\r\n      })\r\n    },\r\n    // 编辑角色\r\n    async editRole (id) {\r\n      this.editRoleDialogVisible = true\r\n      const { data: res } = await this.$axios.get(`roles/${id}`)\r\n      if (res.meta.status !== 200) {\r\n        this.$message.error(res.meta.msg)\r\n      }\r\n      this.editRoleForm = res.data\r\n    },\r\n    // 关闭编辑角色\r\n    editRoleDialogClose () {\r\n      this.$refs.editRoleRef.resetFields()\r\n    },\r\n    // 保存编辑\r\n    saveEditRole () {\r\n      this.$refs.editRoleRef.validate(async bool => {\r\n        if (!bool) return false\r\n        const { data: res } = await this.$axios.put(`roles/${this.editRoleForm.roleId}`, {\r\n          roleName: this.editRoleForm.roleName,\r\n          roleDesc: this.editRoleForm.roleDesc\r\n        })\r\n        if (res.meta.status !== 200) {\r\n          this.$message.error(res.meta.msg)\r\n        } else {\r\n          this.$message.success(res.meta.msg)\r\n          this.editRoleDialogVisible = false\r\n          // 重新获取角色列表\r\n          this.getRoleList()\r\n        }\r\n      })\r\n    },\r\n    // 删除角色\r\n    deleteRole (id) {\r\n      this.$confirm('此操作将永久删除该角色, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        const { data: res } = await this.$axios.delete(`roles/${id}`)\r\n        if (res.meta.status !== 200) {\r\n          this.$message.error(res.meta.msg)\r\n        } else {\r\n          this.$message.success(res.meta.msg)\r\n          // 重新获取用户列表\r\n          this.getRoleList()\r\n        }\r\n      }).catch(() => {\r\n        this.$message.info('取消删除')\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.el-tag {\r\n  margin: 8px;\r\n}\r\n.top {\r\n  border-top: 1px solid #ebeef5;\r\n}\r\n.bottom {\r\n  border-bottom: 1px solid #ebeef5;\r\n}\r\n.nopower {\r\n  text-align: center;\r\n  line-height: 30px;\r\n}\r\n.role-table {\r\n  margin-top: 20px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./RoleList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./RoleList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RoleList.vue?vue&type=template&id=3c9204ee&scoped=true&\"\nimport script from \"./RoleList.vue?vue&type=script&lang=js&\"\nexport * from \"./RoleList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RoleList.vue?vue&type=style&index=0&id=3c9204ee&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3c9204ee\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","addRole","_v","roleList","scopedSlots","_u","key","fn","scope","row","children","length","_l","item","index","id","class","$event","removeRole","_s","authName","list","index2","list2","editRole","deleteRole","settingRole","roleDialogVisible","roleDialogClose","ref","powerList","poserProps","defaultPoserList","slot","saveRoleList","addRoleDialogVisible","addRoleDialogClose","addRoleForm","addRoleFormRules","model","value","callback","$$v","$set","expression","saveAddRole","editRoleDialogVisible","editRoleDialogClose","editRoleForm","editRoleFormRules","saveEditRole","staticRenderFns","data","label","roleId","roleName","roleDesc","required","message","trigger","min","max","created","methods","getRoleList","res","role","confirmButtonText","cancelButtonText","type","then","catch","getPoserKeys","node","arr","keys","idStr","rids","bool","component"],"sourceRoot":""}