"use strict";(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[702],{7444:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addgood-wrapper"},[a("el-card",[a("el-alert",{attrs:{title:"添加商品信息",center:"",type:"success","show-icon":"",closable:!1}}),a("el-steps",{staticClass:"step-box",attrs:{simple:"",space:200,active:e.activeIndex-0,"align-center":!0,"finish-status":"success"}},[a("el-step",{attrs:{title:"基本信息"}}),a("el-step",{attrs:{title:"商品参数"}}),a("el-step",{attrs:{title:"商品属性"}}),a("el-step",{attrs:{title:"商品图片"}}),a("el-step",{attrs:{title:"商品内容"}}),a("el-step",{attrs:{title:"添加商品"}})],1),a("el-form",{ref:"addGoodRef",staticClass:"form-box",attrs:{model:e.addGoodForm,rules:e.addGoodRules,"label-position":"top"}},[a("el-tabs",{staticClass:"tab-box",attrs:{"tab-position":"left","before-leave":e.beforeTabsLeave},on:{"tab-click":e.tabClick},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[a("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.addGoodForm.goods_name,callback:function(t){e.$set(e.addGoodForm,"goods_name",t)},expression:"addGoodForm.goods_name"}})],1),a("el-form-item",{attrs:{label:"商品价格",prop:"goods_price"}},[a("el-input-number",{attrs:{placeholder:"请输入商品价格","controls-position":"right"},model:{value:e.addGoodForm.goods_price,callback:function(t){e.$set(e.addGoodForm,"goods_price",t)},expression:"addGoodForm.goods_price"}})],1),a("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[a("el-input-number",{attrs:{placeholder:"请输入商品数量","controls-position":"right"},model:{value:e.addGoodForm.goods_number,callback:function(t){e.$set(e.addGoodForm,"goods_number",t)},expression:"addGoodForm.goods_number"}})],1),a("el-form-item",{attrs:{label:"商品重量",prop:"goods_weight"}},[a("el-input-number",{attrs:{placeholder:"请输入商品重量","controls-position":"right"},model:{value:e.addGoodForm.goods_weight,callback:function(t){e.$set(e.addGoodForm,"goods_weight",t)},expression:"addGoodForm.goods_weight"}})],1),a("el-form-item",{attrs:{label:"商品分类",prop:"goods_introduce"}},[a("el-cascader",{ref:"cascaderRef",attrs:{options:e.cateList,props:e.addGoodProp},on:{change:e.handleChange},model:{value:e.addGoodForm.goods_cat,callback:function(t){e.$set(e.addGoodForm,"goods_cat",t)},expression:"addGoodForm.goods_cat"}})],1)],1),a("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},e._l(e.manyTabData,(function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-checkbox-group",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}},e._l(t.attr_vals,(function(e,t){return a("el-checkbox",{key:t,attrs:{border:"",label:e}})})),1)],1)})),1),a("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},e._l(e.onlyTabData,(function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-input",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}})],1)})),1),a("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.path,multiple:"",headers:e.header,"list-type":"picture","on-success":e.handleSuccess,"on-remove":e.handleRemove,"on-preview":e.handlePreview}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])])],1),a("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[a("div",{staticStyle:{border:"1px solid #ccc"}},[a("Toolbar",{staticStyle:{"border-bottom":"1px solid #ccc"},attrs:{editor:e.editor,defaultConfig:e.toolbarConfig,mode:e.mode}}),a("Editor",{staticStyle:{height:"400px","overflow-y":"hidden"},attrs:{defaultConfig:e.editorConfig,mode:e.mode},on:{onCreated:e.onCreated},model:{value:e.addGoodForm.goods_introduce,callback:function(t){e.$set(e.addGoodForm,"goods_introduce",t)},expression:"addGoodForm.goods_introduce"}})],1)]),a("el-tab-pane",{attrs:{label:"新增商品",name:"5"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addGood}},[e._v("新增商品")])],1)],1)],1)],1),a("el-dialog",{attrs:{visible:e.imgDialogVisible,width:"30%"},on:{"update:visible":function(t){e.imgDialogVisible=t}}},[a("img",{attrs:{src:e.imgPath,alt:""}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.imgDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.imgDialogVisible=!1}}},[e._v("确 定")])],1)])],1)},r=[],s=a(7906),i=a(6198),n=(a(1539),a(4747),a(4916),a(3123),a(4553),a(561),a(514),a(9600),a(3637)),d=a(69),l=a.n(d),c={data:function(){return{activeIndex:"0",addGoodForm:{goods_name:"",goods_price:0,goods_number:0,goods_weight:0,goods_cat:[],pics:[],goods_introduce:"",attrs:[]},addGoodRules:{goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数量",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_cate:[{required:!0,message:"请选择商品分类",trigger:"blur"}]},addGoodProp:{expandTrigger:"hover",checkStrictly:!0,value:"cat_id",label:"cat_name",children:"children"},cateList:[],manyTabData:[],onlyTabData:[],path:"http://127.0.0.1:8888/api/private/v1/upload",header:{Authorization:window.sessionStorage.getItem("token")},imgDialogVisible:!1,imgPath:"",editor:null,toolbarConfig:{},editorConfig:{placeholder:"请输入内容...",MENU_CONF:{uploadImage:{base64LimitSize:1024e4}}},mode:"simple"}},created:function(){this.getCateList()},methods:{getCateList:function(){var e=this;return(0,i.Z)((0,s.Z)().mark((function t(){var a,o;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("categories");case 2:if(a=t.sent,o=a.data,200===o.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error(o.meta.msg));case 6:e.cateList=o.data;case 7:case"end":return t.stop()}}),t)})))()},handleChange:function(){3!==this.addGoodForm.goods_cat.length&&(this.addGoodForm.goods_cat=[],this.$message.warning("请选择三级分类")),this.$refs.cascaderRef.toggleDropDownVisible()},beforeTabsLeave:function(e,t){if("0"===t&&3!==this.addGoodForm.goods_cat.length)return this.$message.error("请选择商品分类"),!1},tabClick:function(){var e=this;return(0,i.Z)((0,s.Z)().mark((function t(){var a,o,r,i;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("1"!==e.activeIndex){t.next=11;break}return t.next=3,e.$axios.get("categories/".concat(e.addGoodForm.goods_cat[2],"/attributes"),{params:{sel:"many"}});case 3:if(a=t.sent,o=a.data,200===o.meta.status){t.next=7;break}return t.abrupt("return",e.$message.error(o.meta.msg));case 7:o.data.forEach((function(e){e.attr_vals=0===e.attr_vals.length?[]:e.attr_vals.split(",")})),e.manyTabData=o.data,t.next=19;break;case 11:if("2"!==e.activeIndex){t.next=19;break}return t.next=14,e.$axios.get("categories/".concat(e.addGoodForm.goods_cat[2],"/attributes"),{params:{sel:"only"}});case 14:if(r=t.sent,i=r.data,200===i.meta.status){t.next=18;break}return t.abrupt("return",e.$message.error(i.meta.msg));case 18:e.onlyTabData=i.data;case 19:case"end":return t.stop()}}),t)})))()},handleSuccess:function(e){var t={pic:e.data.tmp_path};this.addGoodForm.pics.push(t)},handleRemove:function(e){var t=e.response.data.tem_path,a=this.addGoodForm.pics.findIndex((function(e){return e.pics===t}));this.addGoodForm.pics.splice(a,1)},handlePreview:function(e){this.imgPath=e.response.data.url,this.imgDialogVisible=!0},onCreated:function(e){this.editor=Object.seal(e)},addGood:function(){var e=this;this.$refs.addGoodRef.validate(function(){var t=(0,i.Z)((0,s.Z)().mark((function t(a){var o,r,i;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",e.$message.error("请填写必要信息"));case 2:return o=l().cloneDeep(e.addGoodForm),o.goods_cat=o.goods_cat.join(","),e.manyTabData.forEach((function(t){var a={attr_id:t.attr_id,attr_value:t.attr_vals.join(",")};e.addGoodForm.attrs.push(a)})),e.onlyTabData.forEach((function(t){var a={attr_id:t.attr_id,attr_value:t.attr_vals};e.addGoodForm.attrs.push(a)})),o.attrs=e.addGoodForm.attrs,t.next=9,e.$axios.post("goods",o);case 9:if(r=t.sent,i=r.data,201===i.meta.status){t.next=13;break}return t.abrupt("return",e.$message.error(i.meta.msg));case 13:e.$message.success(i.meta.msg),e.$router.push("/goods");case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},beforeDestroy:function(){var e=this.editor;null!=e&&e.destroy()},components:{Editor:n.M,Toolbar:n.o}},u=c,m=a(1001),p=(0,m.Z)(u,o,r,!1,null,null,null),g=p.exports}}]);
//# sourceMappingURL=702.5d918949.js.map