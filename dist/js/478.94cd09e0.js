(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[478],{1478:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-wrapper"},[r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},on:{clear:e.getUserList},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),r("el-col",{attrs:{span:2}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addUser}},[e._v("新增用户")])],1)],1),r("el-table",{staticClass:"user-table",attrs:{data:e.userList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index",label:"#"}}),r("el-table-column",{attrs:{label:"姓名",prop:"username"}}),r("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),r("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),r("el-table-column",{attrs:{label:"角色",prop:"role_name"}}),r("el-table-column",{attrs:{label:"状态",prop:"mg_state"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.switchStateChange(t.row)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.editUser(t.row.id)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(r){return e.removeUser(t.row.id)}}},[e._v("删除")]),r("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-setting"},on:{click:function(r){return e.settingUser(t.row)}}},[e._v("设置")])]}}])})],1),r("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[1,5,10,20],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"新增用户",width:"30%",visible:e.userAddDialogVisible},on:{"update:visible":function(t){e.userAddDialogVisible=t},close:e.userAddDialogClose}},[r("el-form",{ref:"addUserRef",attrs:{model:e.addUserForm,rules:e.addUserFormRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,"username",t)},expression:"addUserForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password","show-password":""},model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.addUserForm.email,callback:function(t){e.$set(e.addUserForm,"email",t)},expression:"addUserForm.email"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{model:{value:e.addUserForm.mobile,callback:function(t){e.$set(e.addUserForm,"mobile",t)},expression:"addUserForm.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.userAddDialogVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveAddUser}},[e._v("确定")])],1)],1),r("el-dialog",{attrs:{title:"编辑用户",width:"30%",visible:e.userEditDialogVisible},on:{"update:visible":function(t){e.userEditDialogVisible=t},close:e.userEditDialogClose}},[r("el-form",{ref:"editUserRef",attrs:{model:e.editUserForm,rules:e.editUserFormRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editUserForm.username,callback:function(t){e.$set(e.editUserForm,"username",t)},expression:"editUserForm.username"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.editUserForm.email,callback:function(t){e.$set(e.editUserForm,"email",t)},expression:"editUserForm.email"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{model:{value:e.editUserForm.mobile,callback:function(t){e.$set(e.editUserForm,"mobile",t)},expression:"editUserForm.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.userEditDialogVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveEditUser}},[e._v("确定")])],1)],1),r("el-dialog",{attrs:{title:"设置权限",width:"30%",visible:e.userSettingDialogVisible},on:{"update:visible":function(t){e.userSettingDialogVisible=t},close:e.userSettingDialogClose}},[r("el-form",{ref:"settingUserRef",attrs:{model:e.settingUserForm,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.settingUserForm.username,callback:function(t){e.$set(e.settingUserForm,"username",t)},expression:"settingUserForm.username"}})],1),r("el-form-item",{attrs:{label:"角色"}},[r("el-input",{attrs:{disabled:""},model:{value:e.settingUserForm.role_name,callback:function(t){e.$set(e.settingUserForm,"role_name",t)},expression:"settingUserForm.role_name"}})],1),r("el-form-item",{attrs:{label:"新角色"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectRoleId,callback:function(t){e.selectRoleId=t},expression:"selectRoleId"}},e._l(e.rolesList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.userSettingDialogVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveSettingUser}},[e._v("确定")])],1)],1)],1)},a=[],o=r(7906),s=r(6198),i=(r(4916),r(7601),r(1703),r(2222),{data:function(){var e=function(e,t,r){var n=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;if(n.test(t))return r();r(new Error("请输入正确的邮箱"))},t=function(e,t,r){var n=/^1(?:3\d|4[4-9]|5[0-35-9]|6[67]|7[013-8]|8\d|9\d)\d{8}$/;if(n.test(t))return r();r(new Error("请输入正确的手机号"))};return{userList:[],queryInfo:{query:"",pagenum:1,pagesize:5},total:0,userAddDialogVisible:!1,addUserFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:t,trigger:"blur"}]},editUserFormRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:t,trigger:"blur"}]},addUserForm:{username:"",password:"",email:"",mobile:""},userEditDialogVisible:!1,editUserForm:{},settingUserForm:{},userSettingDialogVisible:!1,rolesList:[],selectRoleId:""}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return(0,s.Z)((0,o.Z)().mark((function t(){var r,n;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("users",{params:e.queryInfo});case 2:if(r=t.sent,n=r.data,200===n.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error(n.meta.msg));case 6:e.userList=n.data.users,e.total=n.data.total;case 8:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()},switchStateChange:function(e){var t=this;return(0,s.Z)((0,o.Z)().mark((function r(){var n,a;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.put("users/".concat(e.id,"/state/").concat(e.mg_state));case 2:if(n=r.sent,a=n.data,200===a.meta.status){r.next=7;break}return e.mg_state=!e.mg_state,r.abrupt("return",t.$message.error(a.meta.msg));case 7:case"end":return r.stop()}}),r)})))()},addUser:function(){this.userAddDialogVisible=!0},userAddDialogClose:function(){this.$refs.addUserRef.resetFields()},saveAddUser:function(){var e=this;this.$refs.addUserRef.validate(function(){var t=(0,s.Z)((0,o.Z)().mark((function t(r){var n,a;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,e.$axios.post("users",e.addUserForm);case 4:n=t.sent,a=n.data,201!==a.meta.status?e.$message.error(a.meta.msg):(e.$message.success(a.meta.msg),e.userAddDialogVisible=!1,e.getUserList());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},editUser:function(e){var t=this;return(0,s.Z)((0,o.Z)().mark((function r(){var n,a;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.userEditDialogVisible=!0,r.next=3,t.$axios.get("users/".concat(e));case 3:n=r.sent,a=n.data,200!==a.meta.status&&t.$message.error(a.meta.msg),t.editUserForm=a.data;case 7:case"end":return r.stop()}}),r)})))()},userEditDialogClose:function(){this.$refs.editUserRef.resetFields()},saveEditUser:function(){var e=this;return(0,s.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.editUserRef.validate(function(){var t=(0,s.Z)((0,o.Z)().mark((function t(r){var n,a;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,e.$axios.put("users/".concat(e.editUserForm.id),{email:e.editUserForm.email,mobile:e.editUserForm.mobile});case 4:n=t.sent,a=n.data,200!==a.meta.status?e.$message.error(a.meta.msg):(e.$message.success(a.meta.msg),e.userEditDialogVisible=!1,e.getUserList());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},removeUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,s.Z)((0,o.Z)().mark((function r(){var n,a;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.delete("users/".concat(e));case 2:n=r.sent,a=n.data,200!==a.meta.status?t.$message.error(a.meta.msg):(t.$message.success(a.meta.msg),t.getUserList());case 5:case"end":return r.stop()}}),r)})))).catch((function(){t.$message.info("取消删除")}))},settingUser:function(e){var t=this;return(0,s.Z)((0,o.Z)().mark((function r(){var n,a;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.settingUserForm=e,t.userSettingDialogVisible=!0,r.next=4,t.$axios.get("roles");case 4:if(n=r.sent,a=n.data,200===a.meta.status){r.next=8;break}return r.abrupt("return",t.$message.error(a.meta.msg));case 8:t.rolesList=a.data;case 9:case"end":return r.stop()}}),r)})))()},userSettingDialogClose:function(){this.selectRoleId="",this.settingUserForm={}},saveSettingUser:function(){var e=this;return(0,s.Z)((0,o.Z)().mark((function t(){var r,n;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.selectRoleId){t.next=2;break}return t.abrupt("return",e.$message.error("请选择要分配的角色"));case 2:return t.next=4,e.$axios.put("users/".concat(e.settingUserForm.id,"/role"),{rid:e.selectRoleId});case 4:if(r=t.sent,n=r.data,200===n.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error(n.meta.msg));case 8:e.$message.success(n.meta.msg),e.getUserList(),e.userSettingDialogVisible=!1;case 11:case"end":return t.stop()}}),t)})))()}}}),l=i,u=r(1001),c=(0,u.Z)(l,n,a,!1,null,null,null),d=c.exports},489:function(e,t,r){var n=r(2109),a=r(7293),o=r(7908),s=r(9518),i=r(8544),l=a((function(){s(1)}));n({target:"Object",stat:!0,forced:l,sham:!i},{getPrototypeOf:function(e){return s(o(e))}})},2443:function(e,t,r){var n=r(7235);n("asyncIterator")},6198:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});r(1539);function n(e,t,r,n,a,o,s){try{var i=e[o](s),l=i.value}catch(u){return void r(u)}i.done?t(l):Promise.resolve(l).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var s=e.apply(t,r);function i(e){n(s,a,o,i,l,"next",e)}function l(e){n(s,a,o,i,l,"throw",e)}i(void 0)}))}}},7906:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});r(2526),r(1817),r(1539),r(2165),r(8783),r(3948),r(2443),r(3680),r(3706),r(2703),r(1703),r(489),r(4747),r(8309),r(7042);var n=r(9726);function a(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
a=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(E){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var a=t&&t.prototype instanceof f?t:f,o=Object.create(a.prototype),s=new L(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return $()}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var i=U(s,r);if(i){if(i===m)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=d(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,s),o}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(E){return{type:"throw",arg:E}}}e.wrap=c;var m={};function f(){}function p(){}function g(){}var h={};u(h,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(_([])));b&&b!==t&&r.call(b,s)&&(h=b);var y=g.prototype=f.prototype=Object.create(h);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function a(o,s,i,l){var u=d(e[o],e,s);if("throw"!==u.type){var c=u.arg,m=c.value;return m&&"object"==(0,n.Z)(m)&&r.call(m,"__await")?t.resolve(m.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(m).then((function(e){c.value=e,i(c)}),(function(e){return a("throw",e,i,l)}))}l(u.arg)}var o;this._invoke=function(e,r){function n(){return new t((function(t,n){a(e,r,t,n)}))}return o=o?o.then(n,n):n()}}function U(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=void 0,U(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=d(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,m;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function _(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:$}}function $(){return{value:void 0,done:!0}}return p.prototype=g,u(y,"constructor",g),u(g,"constructor",p),p.displayName=u(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},w(x.prototype),u(x.prototype,i,(function(){return this})),e.AsyncIterator=x,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var s=new x(c(t,r,n,a),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(y),u(y,l,"Generator"),u(y,s,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=_,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(F),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var i=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(i&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),F(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;F(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),m}},e}}}]);
//# sourceMappingURL=478.94cd09e0.js.map